--   -------------------------------------------------- 
--   Generated by Enterprise Architect Version 8.0.856
--   Created On : lunes, 23 diciembre, 2019 
--   DBMS       : PostgreSQL 
--   -------------------------------------------------- 

USE DATABASE postgres
;


--  Drop Tables, Stored Procedures and Views 

DROP TABLE IF EXISTS audit CASCADE
;
DROP TABLE IF EXISTS person CASCADE
;
DROP TABLE IF EXISTS rol CASCADE
;
DROP TABLE IF EXISTS user CASCADE
;

--  Create Tables 
CREATE TABLE audit ( 
	id bigint NOT NULL,
	table_name varchar(50) NOT NULL,
	table_column varchar(50) NOT NULL
)
;

CREATE TABLE person ( 
	id bigint NOT NULL,
	name varchar(50) NOT NULL,
	lastname varchar(50) NOT NULL,
	address varchar(50) NOT NULL,
	phone varchar(50) NOT NULL
)
;

CREATE TABLE rol ( 
	id integer NOT NULL,
	name varchar(50) NOT NULL
)
;

CREATE TABLE user ( 
	id bigint NOT NULL,
	id_person bigint NOT NULL,
	id_rol integer NOT NULL,
	username varchar(50) NOT NULL,
	email varchar(50) NOT NULL,
	password varchar(50) NOT NULL
)
;


--  Create Primary Key Constraints 
ALTER TABLE audit ADD CONSTRAINT PK_audit 
	PRIMARY KEY (id)
;


ALTER TABLE person ADD CONSTRAINT PK_person 
	PRIMARY KEY (id)
;


ALTER TABLE rol ADD CONSTRAINT PK_rol 
	PRIMARY KEY (id)
;


ALTER TABLE user ADD CONSTRAINT PK_user 
	PRIMARY KEY (id)
;




--  Create Foreign Key Constraints 
ALTER TABLE user ADD CONSTRAINT FK_user_person 
	FOREIGN KEY (id_person) REFERENCES person (id)
;

ALTER TABLE user ADD CONSTRAINT FK_user_rol 
	FOREIGN KEY (id_rol) REFERENCES rol (id)
;
